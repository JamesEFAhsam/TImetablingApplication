<!DOCTYPE html>

<?php

/*** begin the session ***/
session_start();

if(!isset($_SESSION['user_id']))
{
    $message = 'You must be logged in to access this page';
	header("Location: /login.php");
}
else
{
    try
    {
        /*** connect to database ***/
        /*** mysql hostname ***/
        $mysql_hostname = 'ebarker.uk.mysql';

        /*** mysql username ***/
        $mysql_username = 'ebarker_uk';

        /*** mysql password ***/
        $mysql_password = 'DCEc8USZjKpaUKdibfmanDwt';

        /*** database name ***/
        $mysql_dbname = 'ebarker_uk';


        /*** select the users name from the database ***/
        $dbh = new PDO("mysql:host=$mysql_hostname;dbname=$mysql_dbname", $mysql_username, $mysql_password);
        /*** $message = a message saying we have connected ***/

        /*** set the error mode to excptions ***/
        $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

        /*** prepare the insert ***/
        $stmt = $dbh->prepare("SELECT username FROM users 
        WHERE user_id = :user_id");

        /*** bind the parameters ***/
        $stmt->bindParam(':user_id', $_SESSION['user_id'], PDO::PARAM_INT);

        /*** execute the prepared statement ***/
        $stmt->execute();

        /*** check for a result ***/
        $username = $stmt->fetchColumn();

        /*** if we have no something is wrong ***/
        if($username == false)
        {
            $message = 'Access Error';
        }
        else
        {
            $message = 'Welcome To SmartRota Website! '.$username;
        }
    }
    catch (Exception $e)
    {
        /*** if we are here, something is wrong in the database ***/
        $message = 'We are unable to process your request. Please try again later"';
    }
}

?>

<html>
	<head>
		<title>Home Page</title>
		<link rel="stylesheet" href="stylesheet.css" type="text/css"/>
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
	</head>

	<body>

	<div class = "tableStart">
	<div class = "tableBody">
	<div class = "tableTitle">
	<div class = "tableCell">
		<h1>SMARTROTA</h1>
	</div>
	</div>
		<div class = "menuList">
			<form action="" >
				<a href="home.html" class = "presentButton" value = "rota">Rota</a>
				<a href="requests.html" class = "menuButton" value = "request">Requests</a>
				<a href="pref.html" class = "menuButton" value = "preference">Preferences</a>
				<a href="ratings.html" class = "menuButton" value = "rating">Ratings</a>
			</form>
		</div>
	</div>
	<br>
	<div class = "tableRow2">
		<div class = "rotaSection">
			<table id="rotaTable">
			<tr>
				<th> STAFF </th>
				<th> MON </th>
				<th> TUES </th>
				<th> WEDS </th>
				<th> THURS </th>
				<th> FRI </th>
				<th> SAT </th>
				<th> SUN </th>
			</tr>
			<tr>
				<td> 9AM - 4PM </td>
				<td> 9AM - 4PM </td>
				<td> 9AM - 4PM </td>
				<td> 9AM - 4PM </td>
				<td> 9AM - 4PM </td>
				<td> 9AM - 4PM </td>
				<td> 9AM - 4PM </td>
				<td> 9AM - 4PM </td>
			</tr>
			<tr>
				<td> 4PM - 11PM </td>
				<td> 4PM - 11PM </td>
				<td> 4PM - 11PM </td>
				<td> 4PM - 11PM </td>
				<td> 4PM - 11PM </td>
				<td> 4PM - 11PM </td>
				<td> 4PM - 11PM </td>
				<td> 4PM - 11PM </td>
			</tr>
			</table>
		</div>
	</div>
	<div class = "commentSection">
		<div class = "comments">
			<br><br>
			<form action="">
				<h2>Manager's Comments:</h2>
				<textarea id="comments" type="" class="comments" value="Sales have been up this week!" readonly></textarea>
				<br><br>
			</form>
			<br><br>
		</div>
	</div>
	<div class = "tableRow4">
		<div class = "tableEnd">
			<h5>SmartRota</h5>
		</div>
	</div>
	</div>
	</div>
<script  src="main.js"></script>
	</body>
</html>
